SELECT Products.ID,Products.[Store UPC] AS SKU,Products.UPC as [UPC],Products.Description as Description,Categories.Topic AS Category,Categories.Serialized as [Serialized], Products.Quantity AS QOH,(SELECT COUNT(SerialNos.SerialNo) From SerialNos Where SerialNos.ProductID = Products.ID AND SerialNos.Hide = 0 AND SerialNos.TransferItemID IS NULL AND SerialNos.ID NOT IN (SELECT SalesItems.SerialID From SalesItems Where SalesItems.Hide = 0 AND SalesItems.SerialID IS NOT NULL)) AS [Ser No Count] From Categories, Products Where Products.Hide = 0 AND Categories.ID = Products.TopicID AND Categories.Serialized <> 1 AND Products.Quantity <> (SELECT COUNT(SerialNos.SerialNo) From SerialNos Where SerialNos.ProductID = Products.ID AND SerialNos.Hide = 0 AND SerialNos.ID NOT IN (SELECT SalesItems.SerialID From SalesItems Where SalesItems.Hide = 0 AND SalesItems.SerialID IS NOT NULL)) AND (SELECT COUNT(SerialNos.SerialNo) From SerialNos Where SerialNos.ProductID = Products.ID AND SerialNos.Hide = 0 AND SerialNos.ID NOT IN (SELECT SalesItems.SerialID From SalesItems Where SalesItems.Hide = 0 AND SalesItems.SerialID IS NOT NULL)) > 0 Union SELECT Products.ID, Products.[Store UPC] AS SKU, Products.UPC, Products.Description,'' AS Category,'' AS [Serialized], Products.Quantity AS QOH, (SELECT COUNT(SerialNos.SerialNo) From SerialNos Where SerialNos.ProductID = Products.ID AND SerialNos.Hide = 0 AND SerialNos.TransferItemID IS NULL AND SerialNos.ID NOT IN (SELECT SalesItems.SerialID From SalesItems Where SalesItems.Hide = 0 AND SalesItems.SerialID IS NOT NULL)) AS [Ser No Count] From Products Where Products.Hide = 0 AND Products.TopicID is NUll AND Products.Quantity <> (SELECT COUNT(SerialNos.SerialNo) From SerialNos Where SerialNos.ProductID = Products.ID AND SerialNos.Hide = 0 AND SerialNos.TransferItemID IS NULL AND SerialNos.ID NOT IN (SELECT SalesItems.SerialID From SalesItems Where SalesItems.Hide = 0 AND SalesItems.SerialID IS NOT NULL)) AND (SELECT COUNT(SerialNos.SerialNo) From SerialNos Where SerialNos.ProductID = Products.ID AND SerialNos.Hide = 0 AND SerialNos.TransferItemID IS NULL AND SerialNos.ID NOT IN (SELECT SalesItems.SerialID From SalesItems Where SalesItems.Hide = 0 AND SalesItems.SerialID IS NOT NULL)) > 0 Union SELECT Products.ID, Products.[Store UPC] AS SKU, Products.UPC, Products.Description, Categories.Topic AS Category,Categories.Serialized,Products.Quantity AS QOH, (SELECT COUNT(SerialNos.SerialNo) From SerialNos Where SerialNos.ProductID = Products.ID AND SerialNos.Hide = 0 AND SerialNos.TransferItemID IS NULL AND SerialNos.ID NOT IN (SELECT SalesItems.SerialID From SalesItems Where SalesItems.Hide = 0 AND SalesItems.SerialID IS NOT NULL)) AS [Ser No Count] From Products, Categories Where Products.TopicID = Categories.ID AND Products.Hide = 0 AND Categories.Serialized = 1 AND Products.Quantity <> (SELECT COUNT(SerialNos.SerialNo) From SerialNos Where SerialNos.ProductID = Products.ID AND SerialNos.Hide = 0 AND SerialNos.TransferItemID IS NULL AND SerialNos.ID NOT IN (SELECT SalesItems.SerialID From SalesItems Where SalesItems.Hide = 0 AND SalesItems.SerialID IS NOT NULL))