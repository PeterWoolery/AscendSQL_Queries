Select Users.LastName, Users.FirstName, (SELECT ROUND(SUM(DATEDIFF(mi,TimeClock.StartTime,TimeClock.EndTime)/60.00),2) From TimeClock WHERE TimeClock.StartTime BETWEEN DATEADD(day, -1, GETDATE())  AND DATEADD(day, +1, GETDATE()) AND TimeClock.Hide = 0 AND Users.ID = TimeClock.UserID) as [Hours Worked], (SELECT SUM(SalesItems.Quantity) From Sales, SalesItems WHERE Sales.FinishDate BETWEEN DATEADD(day, -1, GETDATE())  AND DATEADD(day, +1, GETDATE()) AND Sales.Hide = 0 AND SalesItems.Hide = 0 AND SalesItems.SalesID = Sales.ID AND Users.ID = Sales.CommissionID) as [Total Units], (SELECT SUM(SalesItems.Quantity * SalesItems.Price)  From Sales, SalesItems WHERE Sales.FinishDate BETWEEN DATEADD(day, -1, GETDATE())  AND DATEADD(day, +1, GETDATE()) AND Sales.Hide = 0 AND SalesItems.Hide = 0 AND SalesItems.SalesID = Sales.ID AND Users.ID = Sales.CommissionID) as [Total Sales],  (SELECT SUM(SalesItems.Quantity * SalesItems.COGS) From Sales, SalesItems WHERE Sales.FinishDate BETWEEN DATEADD(day, -1, GETDATE())  AND DATEADD(day, +1, GETDATE()) AND Sales.Hide = 0 AND SalesItems.Hide = 0 AND SalesItems.SalesID = Sales.ID AND Users.ID = Sales.CommissionID) as [Total Cost], (SELECT (SUM(SalesItems.Quantity * SalesItems.Price)) - (SUM(SalesItems.Quantity * SalesItems.COGS)) From Sales, SalesItems WHERE Sales.FinishDate BETWEEN DATEADD(day, -1, GETDATE())  AND DATEADD(day, +1, GETDATE()) AND Sales.Hide = 0  AND SalesItems.Hide = 0 AND SalesItems.SalesID = Sales.ID AND Users.ID = Sales.CommissionID) as [Total Profit],   [Profit Per Hour] = CASE  WHEN (SELECT ROUND(SUM(DATEDIFF(mi,TimeClock.StartTime,TimeClock.EndTime)/60.00),2)  From TimeClock  WHERE TimeClock.StartTime BETWEEN DATEADD(day, -1, GETDATE())  AND DATEADD(day, +1, GETDATE()) AND TimeClock.Hide = 0 AND Users.ID = TimeClock.UserID) = 0 THEN 0 ELSE ROUND(((SELECT (SUM(SalesItems.Quantity * SalesItems.Price))-(SUM(SalesItems.Quantity * SalesItems.COGS)) From Sales, SalesItems WHERE Sales.FinishDate BETWEEN DATEADD(day, -1, GETDATE())  AND DATEADD(day, +1, GETDATE()) AND Sales.Hide = 0 AND SalesItems.Hide = 0 AND SalesItems.SalesID = Sales.ID AND Users.ID = Sales.CommissionID)/ (SELECT ROUND(SUM(DATEDIFF(mi,TimeClock.StartTime,TimeClock.EndTime)/60.00),2)  From TimeClock WHERE TimeClock.StartTime BETWEEN DATEADD(day, -1, GETDATE())  AND DATEADD(day, +1, GETDATE()) AND TimeClock.Hide = 0 AND Users.ID = TimeClock.UserID)),2) END,[Sales Per Hour] = CASE WHEN (SELECT ROUND(SUM(DATEDIFF(mi,TimeClock.StartTime,TimeClock.EndTime)/60.00),2) From TimeClock WHERE TimeClock.StartTime BETWEEN DATEADD(day, -1, GETDATE())  AND DATEADD(day, +1, GETDATE()) AND TimeClock.Hide = 0 AND Users.ID = TimeClock.UserID) = 0 THEN 0 ELSE ROUND(((SELECT SUM(Sales.Subtotal) From Sales WHERE Sales.FinishDate BETWEEN DATEADD(day, -1, GETDATE())  AND DATEADD(day, +1, GETDATE()) AND Sales.Hide = 0 AND Users.ID = Sales.CommissionID)/(SELECT ROUND(SUM(DATEDIFF(mi,TimeClock.StartTime,TimeClock.EndTime)/60.00),2)  From TimeClock WHERE TimeClock.StartTime BETWEEN DATEADD(day, -1, GETDATE())  AND DATEADD(day, +1, GETDATE()) AND TimeClock.Hide = 0 AND Users.ID = TimeClock.UserID)),2) End, (SELECT CONVERT(date,GETDATE())) From Users WHERE ID <> 'efffffff-efff-effe-fffe-fffffffffffe' ORDER BY [Hours Worked] DESC, [Total Sales] DESC