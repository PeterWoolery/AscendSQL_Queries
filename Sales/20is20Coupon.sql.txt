SELECT DISTINCT Locations.Name, SUM((SalesItems.Price-SalesItems.COGS)*SalesItems.Quantity) AS [Gross Margin], Sales.Barcode FROM Locations, Sales, SalesItems, Payments, Coupon WHERE Locations.ActiveStore = 1 AND Sales.ID = SalesItems.SalesID AND Payments.SalesID = Sales.ID AND Payments.PaymentType = 'Coupon' AND Payments.DateCreated BETWEEN '20190918' AND GETDATE() AND SalesItems.Hide <> 1 AND Payments.Hide <> 1 AND Coupon.Code = '20I11231236L'  AND Coupon.ID = Payments.CouponID GROUP BY Locations.Name, Sales.Barcode