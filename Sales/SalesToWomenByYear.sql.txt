SELECT DATEPART(yy, Sales.FinishDate), SUM(Payments.Amount)/(SELECT SUM(Payments.Amount) From Payments, Sales WHERE Payments.SalesID = Sales.ID) AS [% Dollars From Women], COUNT(DISTINCT(Payments.SalesID)) AS [Transaction % of Women] FROM Sales, Customers, Payments WHERE Customers.ID = Sales.CustomerID AND Payments.SalesID = Sales.ID AND Customers.Gender = 0 GROUP BY DATEPART(yy, Sales.FinishDate);