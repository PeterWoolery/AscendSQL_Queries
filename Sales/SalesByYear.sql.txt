SELECT YEAR(Sales.FinishDate) AS Year, SUM(SalesItems.MSRP * SalesItems.Quantity) AS MSRP, SUM((SalesItems.MSRP - SalesItems.Price) * SalesItems.Quantity) AS Discount, SUM(SalesItems.Price * SalesItems.Quantity) AS Sales, SUM(SalesItems.COGS * SalesItems.Quantity) AS Cost, SUM((SalesItems.Price - SalesItems.COGS) * SalesItems.Quantity) AS Profit, Margin = CASE WHEN SUM(SalesItems.price * SalesItems.Quantity) = 0 THEN 0 ELSE SUM((SalesItems.Price - SalesItems.COGS) * SalesItems.Quantity) / SUM (SalesItems.price * SalesItems.Quantity) * 100 End FROM Sales INNER JOIN SalesItems ON Sales.ID = SalesItems.SalesID INNER JOIN Products ON SalesItems.ProductID = Products.ID Where (Sales.Hide <> 1 Or Sales.Hide Is Null) AND (SalesItems.Hide <> 1 OR SalesItems.Hide IS NULL) AND Sales.FinishDate BETWEEN <<StartDate>> AND <<EndDate>> GROUP BY YEAR(Sales.FinishDate) ORDER BY YEAR(Sales.FinishDate)