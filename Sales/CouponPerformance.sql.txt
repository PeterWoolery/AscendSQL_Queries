SELECT Locations.Name, SUM(SalesItems.Quantity*SalesItems.Price) AS [Sales Generated], SUM(SalesItems.Quantity*SalesItems.Price)-SUM(SalesItems.Quantity*SalesItems.COGS) AS [Gross Margin Generated], COUNT(DISTINCT(Sales.ID)) AS [Transactions] FROM Locations, Sales, SalesItems, Payments, Coupon WHERE Sales.ID = SalesItems.SalesID AND Payments.SalesID = Sales.ID AND Coupon.ID = Payments.CouponID AND Coupon.Code LIKE 'SUMMER19%' AND Locations.ActiveStore = 1 GROUP BY Locations.Name